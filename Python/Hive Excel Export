import pyhs2
import xlsxwriter

with pyhs2.connect(host='host_name',
port=port_num,
authMechanism="PLAIN",
user='username',
password='password',
database='default') as conn:
    with conn.cursor() as cur:
        jList = []
        cur.execute("select * from table_name)
        book = xlsxwriter.Workbook("test.xlsx")
        sheet = book.add_worksheet('temp')
        headers = ['col_1', 'col_2', 'col_3']
        col = 0
        row = 0
    for h in headers:
        sheet.write(row, col, h)
        col += 1
    row = 1
    col = 0

    # Write data
    for x in jList:
        sheet.write_row(row, col, ['col_1', 'col_2', 'col_3'])
        row += 1
    for r in result:
        sheet.write_row(row, col, r)
        row += 2

    # Save/Exit
    book.close()
